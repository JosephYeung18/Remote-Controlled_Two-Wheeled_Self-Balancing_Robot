# Remote-Controlled_Two-Wheeled_Self-Balancing_Robot

# 🤖 远程控制两轮自平衡机器人项目

基于STM32F401RE的远程控制两轮自平衡机器人，集成MPU6500姿态传感器、蓝牙通信和超声波避障功能。通过FreeRTOS实现多任务调度，采用PID控制算法保持平衡，支持手机APP远程控制。

## 🚀 核心功能

- **自平衡控制**：基于MPU6500传感器数据，通过PID算法实现稳定平衡
- **远程控制**：支持蓝牙无线控制，实现前进、后退、转弯等动作
- **避障功能**：集成超声波传感器，自动检测障碍物并规避
- **实时数据显示**：OLED屏幕实时显示姿态数据和系统状态
- **安全机制**：倾角过大自动断电，蓝牙断开自动停止

## 🛠️ 硬件清单

| 组件              | 型号/规格               | 数量 | 功能描述                  |
|-------------------|-------------------------|------|---------------------------|
| 主控板            | STM32F401RE Nucleo      | 1    | 主控制器                  |
| 电机驱动          | AT8236                  | 1    | 电机驱动                  |
| 电机              | MC520                   | 2    | 驱动轮                    |
| 姿态传感器        | MPU6500                 | 1    | 检测机器人姿态            |
| 超声波传感器      | HC-SR04                 | 1    | 障碍物检测                |
| 蓝牙模块          | HC-05                   | 1    | 无线通信                  |
| OLED显示屏        | SSD1306 0.96寸          | 1    | 显示系统状态              |
| 电源              | 12V锂电池组             | 1    | 供电                      |
| 电位器/按键       | 三联电位器+4按键        | 1    | 参数调节和紧急停止        |

## 📁 核心代码结构

```
Core/
├── Inc/                # 头文件
│   ├── adc.h           # ADC配置
│   ├── gpio.h          # GPIO配置
│   ├── i2c.h           # I2C配置
│   ├── usart.h         # USART配置
│   └── ...
├── Src/                # 源文件
│   ├── main.c          # 主函数
│   ├── stm32f4xx_hal_msp.c # 硬件抽象层
│   ├── system_stm32f4xx.c   # 系统配置
│   └── ...
├── Startup/            # 启动文件
│   └── startup_stm32f401xe.s # 启动汇编代码
├── mpu6500/            # MPU6500传感器驱动
│   ├── inv_mpu.c       # MPU驱动核心
│   ├── inv_mpu_dmp_motion_driver.c # DMP驱动
│   └── ...
├── oled/               # OLED显示驱动
├── motor/              # 电机控制
├── pid/                # PID控制算法
├── sr04/               # 超声波传感器驱动
└── encoder/            # 编码器驱动
```

## 🚀 功能实现

### 🔄 自平衡控制
通过MPU6500获取姿态数据，使用级联PID控制算法实现自平衡：
- **垂直环**：PD控制，维持机器人直立
- **速度环**：PI控制，控制前进后退速度
- **转向环**：PD控制，控制转向角度

### 📱 远程控制
通过HC-05蓝牙模块与手机APP通信，支持以下指令：
- 前进
- 后退
- 左转
- 右转
- 停止
- 速度调节

### 🚧 避障功能
超声波传感器检测前方障碍物，当距离小于设定阈值时自动触发避障动作：
- 检测距离范围：2-400cm
- 响应时间：<100ms
- 避障策略：后退+转向

### 📊 数据显示
OLED显示屏实时显示：
- 姿态角度（俯仰角、横滚角）
- 电机转速
- 超声波距离
- 蓝牙连接状态
- 电池电量

## ⚙️ 使用说明

### 🔌 硬件连接
| 模块        | STM32引脚    | 备注                |
|-------------|--------------|---------------------|
| MPU6500     | I2C1(SCL:PB6, SDA:PB7) | -                   |
| OLED        | I2C1(SCL:PB6, SDA:PB7) | -                   |
| HC-SR04     | TRIG:PC6, ECHO:PC7      | -                   |
| HC-05       | USART2(PA2:TX, PA3:RX)  | 波特率9600          |
| 电机驱动    | PWM:PA8/PA9, DIR:PB0/PB1| -                   |

### 📝 软件配置
1. 打开项目文件 `STM32_Balance_Robot.ioc` 配置STM32CubeMX参数
2. 编译并下载程序到STM32F401RE
3. 使用蓝牙调试APP连接HC-05（默认密码：1234）
4. 上传手机控制APP到Android设备

### 🎮 操作步骤
1. 开机，等待系统初始化完成
2. 手动扶正机器人至平衡位置
3. 手机连接蓝牙
4. 通过APP发送控制指令
5. 操作结束后按停止键，关闭电源

## 调试工具
- STM32CubeIDE：开发环境
- ST-Link/V2：下载调试器
- 串口调试助手：查看系统日志
- 逻辑分析仪：调试I2C/SPI通信

## PID参数调节
通过三联电位器调节PID参数：
- **P（比例）**：增大可加快响应速度，但过大会导致振荡
- **I（积分）**：消除静态误差，过大会导致超调
- **D（微分）**：抑制振荡，改善动态响应

## 🚨 安全注意事项
- 操作时保持机器人平衡，避免倾倒损坏
- 调试时远离障碍物和人群
- 电池充电时注意安全，避免过充
- 发现异常立即按下紧急停止按钮


## 📝 使用说明
1. 确保所有硬件连接正确，电源正常
2. 上传代码到STM32开发板烧录
3. 通过蓝牙连接到机器人
4. 使用手机蓝牙APP发送控制指令
5. 通过OLED显示屏查看实时状态

## 📹 功能演示
![image](./images/your-image.png)

## 📄 项目文档


